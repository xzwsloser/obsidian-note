> 这一个部分我其实有很多地方没有仔细看,另外这一部分有大量的内容作者也只是介绍了一部分,所以我这里就总结一些比较基本的文件系统和文件系统实现方式相关的例子
## IO设备
- 一个计算机系统的各种`IO`设备的一个经典架构如下(`IO`设备也就是对于内存进行读写的各种设备,比如硬盘,显卡等):
![[Pasted image 20241107164801.png]]
- 这里的各种总线的性质不同并且传递数据的速度也不同
### 标准设备 
- 这里标准设备的一个抽象方式适用于各种硬件,也就是各种硬件向操作系统提供接口,操作系统利用这些接口来实现各种系统调用从而完成对于硬件的控制,一个典型的标准设备如下:
![[Pasted image 20241107165109.png]]
- 这里底层的硬件向上一层提供各种接口(比如状态寄存器,命令寄存器,数据寄存器等)
- 同时标准设备依托于标准协议完成操作系统与硬件之间的交互,一个例子比如操作系统可以通过不断读取硬件提供的接口中的状态寄存器的值来判断硬件的状态从而决定什么时候发送请求,这里如果`CPU`使用轮询的方式完成对于硬件状态的判断就会到时这里会浪费大量的时间,所以此时硬件采用中断的方式,也就是硬件完成某一个请求或者发生故障的时候会进行一个时钟中断来同时`CPU`,所以此时就可以让`IO`操作与`CPU`计算并行执行:
![[Pasted image 20241107165522.png]]
### DMA
- 但是如果考虑到`CPU`还需要从内存送到硬盘硬盘才可以开始`IO`操作,这就又会产生时间的浪费,所以这里利用`DMA`来借助`CPU`完成数据从内存到磁盘的转义,`DMA`可以协调内存与各种设备之间的数据传递并且不需要`CPU`介入,利用`DMA`那么此时的时序图如下(并且`DMA`可以通过中断来向`CPU`发送命令完成的信号,中断就类似于进程中的信号):
![[Pasted image 20241107165808.png]]
### 设备的交互方式
- 内存映射: 操作系统把设备寄存器的值当成内存地址使用,这样就可以在每一次读取的时候像读取进程地址空间中存储的变量一样读取到数据了
- 特权指令(比如各种`IO`指令),通过`IO`指令完成设备之间的交互
### 驱动程序
- 操作系统的一部分就是驱动程序
- 驱动程序解决的问题就是对于同一个操作系统,不同的设备提供不一样的接口,那么如何统一各种设备的接口使用方式,这里驱动程序其实也就是一个中间层,把硬件接口转换为操作系统可用的,统一的接口,比如文件系统栈如下:
![[Pasted image 20241107170522.png]]
- 这样对于不同的设备就可以统一交互方式了
## 磁盘驱动器(磁盘)
- 偏向于硬件并且过时,不做阐述
## RAID
- 本质上是一个系统,充当磁盘驱动器的作用,可以提供各种数据存储服务和差错校验方式,不做阐述
